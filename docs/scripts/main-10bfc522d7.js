"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Utils=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"sample",value:function(e){return e[randomTo(e.length)]}},{key:"randomTo",value:function(e){var t=Math.random();return Math.floor(t*e)}},{key:"shufflePair",value:function(e){var t=Math.random(),n=Math.floor(2*t),r=(n+1)%2;return[e[n],e[r]]}},{key:"capitalize",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Person=function(){function e(t,n){_classCallCheck(this,e),this.id=n,this.person=t[n]}return _createClass(e,[{key:"name",get:function(){return this.person.name}},{key:"heOrShe",get:function(){return"m"===this.person.gender?"he":"she"}},{key:"himOrHer",get:function(){return"m"===this.person.gender?"him":"her"}},{key:"hisOrHer",get:function(){return"m"===this.person.gender?"his":"her"}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),SHIPS=[[{name:"Sherlock",gender:"m"},{name:"John",gender:"m"}],[{name:"Steve",gender:"m"},{name:"Tony",gender:"m"}],[{name:"Han Solo",gender:"m"},{name:"Princess Leia",gender:"f"}],[{name:"Kirk",gender:"m"},{name:"Spock",gender:"m"}],[{name:"Natasha",gender:"f"},{name:"Bruce",gender:"m"}],[{name:"Starlord",gender:"m"},{name:"Gamora",gender:"f"}]],Ship=function(){function e(t,n,r){if(_classCallCheck(this,e),void 0!==t){n=void 0===n?Utils.randomTo(2):n,r=void 0===r?(n+1)%2:r;var a=SHIPS[t];this.id=t,this.personOne=new Person(a,n),this.personTwo=new Person(a,r)}}return _createClass(e,null,[{key:"all",get:function(){return SHIPS}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),TROPES={MAIN:["PERSON_1 and PERSON_2 have to pretend to be in a relationship.","PERSON_1 and PERSON_2 have to share a bed.","PERSON_1 and PERSON_2 wind up in a Canadian shack.","PERSON_1 has a nightmare. PERSON_2 wakes him_or_her_1 up. ","Somebody gives PERSON_1 the shovel talk about PERSON_2. ","AU: PERSON_1 runs a coffee shop where PERSON_2 is a regular.","PERSON_1 grows a mustache. PERSON_2 is not a fan.","PERSON_1 gets de-aged. Is this really part of PERSON_2's job description?","PERSON_1 & PERSON_2: Aliens or bad guys made them do it.","PERSON_1 and PERSON_2 must fuck or they will die.","PERSON_1 is in handcuffs. PERSON_2 has the key.","PERSON_1 gets really, really drunk... and gets a little too honest with PERSON_2.","PERSON_1 and PERSON_2 do something even more domestic than pick out curtains.","PERSON_1 and PERSON_2 are on the run from the law.","PERSON_1 isn't speaking to PERSON_2. He_Or_She_1 knows what he_or_she_1 did.","PERSON_1 is pretending to be in a relationship to make PERSON_2 jealous. (It's successful.)","PERSON_1 patches up PERSON_2 after an adventure gone wrong.","PERSON_1 gets amnesia. PERSON_2 has a lot of Feelings about it. ","PERSON_1 and PERSON_2 accidentally swap bodies.","PERSON_1 gets turned into a kitten. Is this really part of PERSON_2's job description?","PERSON_1 and PERSON_2 are from the 50's. Who doesn't look great in a leather jacket?","PERSON_1 is on the road to becoming a villain. Only PERSON_2 can bring him_or_her_1 back from the brink.","PERSON_1 and PERSON_2 wake up in bed together... and they're not sure what happened last night.","PERSON_1 and PERSON_2 get up to some shenanigans in public.","Everyone thinks PERSON_1 and PERSON_2 are dating. What is up with THAT?!","Everyone is conspiring to get PERSON_1 and PERSON_2 together.",'PERSON_1 has a birthday and PERSON_2 doesn\'t notice, what with the whole "busy saving the world" thing.',"PERSON_1 and PERSON_2 run into each other on Tindr. Oops.","PERSON_1 and PERSON_2 had a one-night stand, years ago. Now, they have to work together — but PERSON_2 doesn't seem to remember. This is awkward.","PERSON_1 and PERSON_2 are cellmates together. That doesn't mean they have to like it.","PERSON_1 is failing a class. PERSON_2 is his_or_her_1 tutor.","PERSON_1 is the star of the newest hit Broadway Musical. PERSON_2 is a very finicky reviewer. When they meet, sparks fly. AU.","PERSON_1 is sure his_or_her_1 senior year of high school is going to be just as predictable as the three years that preceded it. Then he_or_she_1 meets PERSON_2, who's from the wrong side of the tracks — suddenly, nothing seems so certain anymore. HS AU.","PERSON_1 and PERSON_2 are set up in an arranged marriage by their parents.","PERSON_1 is having a horrible day. Fortunately, PERSON_2 is there to pile on.","PERSON_1 is just trying to get to retirement peacefully. Unfortunately for him_or_her_1, PERSON_2 is his_or_her_1 partner."],SECONDARY:["Unexpectedly, somebody has tentacles.","PERSON_2 has had an erection for more than four hours.","Plus, it turns out that PERSON_1 really likes to be spanked.","They also go to a Beyonce concert.","Everybody is, for some reason, a werewolf.","There is a nonzero amount of voyeurism.","A breeding stand is involved. You decide how. And why.","Two words: Nipple Clamps.","Plus, it turns out PERSON_1 really likes to be called Daddy.","Unrelatedly, PERSON_2 is wearing a chastity belt.","Plus, it turns out PERSON_2 is really into cross-dressing.","The handcuffs were official at first. Later, they're just for fun.","A dildo makes a surprise guest appearance.","Somebody engages in phone sex.","Creator chose not to use archive warnings.","Unexpectedly, someone is a virgin.","One rule: no hands.","PERSON_1 is NOT amused by his_or_her_1 new nickname.","Eventually, PERSON_1 gets a little tied up. By PERSON_2.","Non-traditional restraints make an appearance.","Most importantly, this is a Very Special Episode.","This is a musical episode.","And SOMEBODY forgot to wear underwear today.","Sex pollen makes an appearance.","Meanwhile, a sexy text goes awry.",'The author is clearly uncomfortable with the word "cock".',"Also, PERSON_2 likes being in trouble. I mean, realllllllyyy likes trouble.","Also, PERSON_1 is maybe just sliiiiightly lying about his_or_her_1 past?",'Also, PERSON_2 is so not into this whole "rules" thing.',"Someone dresses in drag.","Someone is in denial.","Someone might have a teensy thing for dirty talk.","Nobody expects the Spanish Inquisition."]},Trope=function(){function e(t,n,r){_classCallCheck(this,e);var a=e.TROPES[t];this._ship=n,this._type=t,this.id=r||Utils.randomTo(a.length),this.text=this.personalize(n)}return _createClass(e,[{key:"personalize",value:function(e){var t=this.getBaseTrope();return t=this.updateTrope(t,"PERSON_1",this._ship.personOne.name),t=this.updateTrope(t,"he_or_she_1",this._ship.personOne.heOrShe),t=this.updateTrope(t,"He_Or_She_1",this._ship.personOne.heOrShe,!0),t=this.updateTrope(t,"him_or_her_1",this._ship.personOne.himOrHer),t=this.updateTrope(t,"his_or_her_1",this._ship.personOne.hisOrHer),t=this.updateTrope(t,"PERSON_2",this._ship.personTwo.name),t=this.updateTrope(t,"he_or_she_2",this._ship.personTwo.heOrShe),t=this.updateTrope(t,"He_Or_She_2",this._ship.personTwo.heOrShe,!0),t=this.updateTrope(t,"him_or_her_2",this._ship.personTwo.himOrHer),t=this.updateTrope(t,"his_or_her_2",this._ship.personTwo.hisOrHer)}},{key:"updateTrope",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new RegExp(t,"g"),i=r?Utils.capitalize(n):n;return e.replace(a,i)}},{key:"getBaseTrope",value:function(){return e.TROPES[this._type][this.id]}}]),e}();Trope.MAIN="MAIN",Trope.SECONDARY="SECONDARY",Trope.TROPES=TROPES;var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Idea=function(){function e(t,n,r){_classCallCheck(this,e),t&&(self.isBlank=!1,this.ship=t,this.mainTrope=new Trope(Trope.MAIN,t,n),this.secondaryTrope=new Trope(Trope.SECONDARY,t,r))}return _createClass(e,null,[{key:"blank",value:function(){var t=new e;return t.isBlank=!0,t.ship={},t.mainTrope={text:"Choose a ship,"},t.secondaryTrope={text:"hit the button, and get inspired!"},t}}]),e}(),_slicedToArray=function(){function e(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),URL="https://sirnotappearinginthisfic.github.io/ficgenerator/",PermaLink=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"fromUrl",value:function(){var e=location.search;return this.parseQuery(e)}},{key:"toLink",value:function(t,n){var r=e.toQueryParams(t,n);return""+URL+r}},{key:"toQueryParams",value:function(e,t){if(e&&void 0!==e.id){var n=(e.id,e.personOne.id),r=e.personTwo.id,a=t.mainTrope.id,i=t.secondaryTrope.id;return"?idea=s"+e.id+"p"+n+"p"+r+"m"+a+"s"+i}}},{key:"parseQuery",value:function(e){var t=this.matchIds(e);if(t){var n=_slicedToArray(t,5),r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],h=new Ship(r,a,i);return{ship:h,idea:new Idea(h,o,s)}}}},{key:"matchIds",value:function(e){var t=e.match(/\?idea=s(\d+)p(\d+)p(\d+)m(\d+)s(\d+)$/);if(t)return t.slice(1).map(function(e){return parseInt(e)})}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),FicGenerator=function(){function e(t){var n=this;_classCallCheck(this,e),this.$shipSelector=t("#ship-selector"),this.$goButton=t("#go"),this.$mainTrope=t("#main-trope"),this.$secondaryTrope=t("#secondary-trope"),this.$link=t("#link"),this.$linkContainer=t("#link-container"),this.ship=void 0,this.idea=void 0,this.setupShips(),this.firstIdea(),this.$goButton.click(this.onGo.bind(this)),window.addEventListener("popstate",function(e){n.firstIdea()})}return _createClass(e,[{key:"setupShips",value:function(){var e=this;Ship.all.map(this.shipOption).forEach(function(t){return e.$shipSelector.append(t)})}},{key:"onGo",value:function(){this.generateIdea()}},{key:"shipOption",value:function(e,t){return'<option value="'+t+'">'+e.map(function(e){return e.name}).join("/")+"</option>"}},{key:"generateIdea",value:function(){var e=this.$shipSelector.val();""===e?(this.ship=new Ship,this.idea=Idea.blank()):(this.ship=new Ship(parseInt(e)),this.idea=new Idea(this.ship)),this.renderIdea(),this.updateHistory()}},{key:"renderIdea",value:function(){this.$mainTrope.text(this.idea.mainTrope.text),this.$secondaryTrope.text(this.idea.secondaryTrope.text),this.renderLink()}},{key:"renderLink",value:function(){if(this.idea.isBlank)this.$link.text(),this.$link.attr("href",""),this.$linkContainer.addClass("hidden");else{var e=PermaLink.toLink(this.ship,this.idea);this.$link.text(e),this.$link.attr("href",e),this.$linkContainer.removeClass("hidden")}}},{key:"updateHistory",value:function(){history.pushState(null,null,PermaLink.toQueryParams(this.ship,this.idea))}},{key:"firstIdea",value:function(){var e=PermaLink.fromUrl();if(e){var t=e.ship,n=e.idea;this.ship=t,this.idea=n,this.chooseShip(t),this.renderIdea(n)}else this.generateIdea()}},{key:"chooseShip",value:function(e){this.$shipSelector.val(e.id)}}]),e}();jQuery(function(e){new FicGenerator(e)});