"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),Utils=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"sample",value:function(e){return e[randomTo(e.length)]}},{key:"randomTo",value:function(e){var n=Math.random();return Math.floor(n*e)}},{key:"shufflePair",value:function(e){var n=Math.random(),t=Math.floor(2*n),r=(t+1)%2;return[e[t],e[r]]}},{key:"capitalize",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}]),e}(),_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),Person=function(){function e(n,t){_classCallCheck(this,e),this.id=t,this.person=n[t]}return _createClass(e,[{key:"name",get:function(){return this.person.name}},{key:"heOrShe",get:function(){return"m"===this.person.gender?"he":"she"}},{key:"himOrHer",get:function(){return"m"===this.person.gender?"him":"her"}},{key:"hisOrHer",get:function(){return"m"===this.person.gender?"his":"her"}}]),e}(),_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),SHIPS=[[{name:"Sherlock",gender:"m"},{name:"John",gender:"m"}],[{name:"Steve",gender:"m"},{name:"Tony",gender:"m"}],[{name:"Han Solo",gender:"m"},{name:"Princess Leia",gender:"f"}],[{name:"Kirk",gender:"m"},{name:"Spock",gender:"m"}],[{name:"Natasha",gender:"f"},{name:"Bruce",gender:"m"}],[{name:"Starlord",gender:"m"},{name:"Gamora",gender:"f"}]],Ship=function(){function e(n,t,r){if(_classCallCheck(this,e),n){t=void 0===t?Utils.randomTo(2):t,r=void 0===r?(t+1)%2:r;var a=SHIPS[n];this.id=n,this.personOne=new Person(a,t),this.personTwo=new Person(a,r)}}return _createClass(e,null,[{key:"all",get:function(){return SHIPS}}]),e}(),_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),TROPES={MAIN:["PERSON_1 and PERSON_2 have to pretend to be in a relationship.","PERSON_1 and PERSON_2 have to share a bed.","PERSON_1 and PERSON_2 wind up in a Canadian shack.","PERSON_1 has a nightmare. PERSON_2 wakes him_or_her_1 up. ","Somebody gives PERSON_1 the shovel talk about PERSON_2. ","AU: PERSON_1 runs a coffee shop where PERSON_2 is a regular.","PERSON_1 grows a mustache. PERSON_2 is not a fan.","PERSON_1 gets de-aged. Is this really part of PERSON_2's job description?","PERSON_1 & PERSON_2: Aliens or bad guys made them do it.","PERSON_1 and PERSON_2 must fuck or they will die.","PERSON_1 is in handcuffs. PERSON_2 has the key.","PERSON_1 gets really, really drunk... and gets a little too honest with PERSON_2.","PERSON_1 and PERSON_2 do something even more domestic than pick out curtains.","PERSON_1 and PERSON_2 are on the run from the law.","PERSON_1 isn't speaking to PERSON_2. He_Or_She_1 knows what he_or_she_1 did.","PERSON_1 is pretending to be in a relationship to make PERSON_2 jealous. (It's successful.)","PERSON_1 patches up PERSON_2 after an adventure gone wrong.","PERSON_1 gets amnesia. PERSON_2 has a lot of Feelings about it. ","PERSON_1 and PERSON_2 accidentally swap bodies.","PERSON_1 gets turned into a kitten. Is this really part of PERSON_2's job description?","PERSON_1 and PERSON_2 are from the 50's. Who doesn't look great in a leather jacket?","PERSON_1 is on the road to becoming a villain. Only PERSON_2 can bring him_or_her_1 back from the brink.","PERSON_1 and PERSON_2 wake up in bed together... and they're not sure what happened last night.","PERSON_1 and PERSON_2 get up to some shenanigans in public.","Everyone thinks PERSON_1 and PERSON_2 are dating. What is up with THAT?!","Everyone's friends are conspiring to get PERSON_1 and PERSON_2 together."],SECONDARY:["Unexpectedly, somebody has tentacles.","PERSON_2 has had an erection for more than four hours.","Plus, it turns out that PERSON_1 really likes to be spanked.","They also go to a Beyonce concert.","Everybody is, for some reason, a werewolf.","There is a nonzero amount of voyeurism.","A breeding stand is involved. You decide how. And why.","Two words: Nipple Clamps.","Plus, it turns out PERSON_1 really likes to be called Daddy.","Unrelatedly, PERSON_2 is wearing a chastity belt.","Plus, it turns out PERSON_2 is really into cross-dressing.","The handcuffs were official at first. Later, they're just for fun.","A dildo makes a surprise guest appearance.","Somebody engages in phone sex.","Creator chose not to use archive warnings.","Unexpectedly, someone is a virgin.","One rule: no hands.","PERSON_1 is NOT amused by his_or_her_1 new nickname.","Eventually, PERSON_1 gets a little tied up. By PERSON_2.","Non-traditional restraints make an appearance.","Most importantly, this is a Very Special Episode.","This is a musical episode.","And SOMEBODY forgot to wear underwear today.","Sex pollen makes an appearance.","Meanwhile, a sexy text goes awry.",'The author is clearly uncomfortable with the word "cock".']},Trope=function(){function e(n,t,r){_classCallCheck(this,e);var a=e.TROPES[n];this._ship=t,this._type=n,this.id=r||Utils.randomTo(a.length),this.text=this.personalize(t)}return _createClass(e,[{key:"personalize",value:function(e){var n=this.getBaseTrope();return n=this.updateTrope(n,"PERSON_1",this._ship.personOne.name),n=this.updateTrope(n,"he_or_she_1",this._ship.personOne.heOrShe),n=this.updateTrope(n,"He_Or_She_1",this._ship.personOne.heOrShe,!0),n=this.updateTrope(n,"him_or_her_1",this._ship.personOne.himOrHer),n=this.updateTrope(n,"his_or_her_1",this._ship.personOne.hisOrHer),n=this.updateTrope(n,"PERSON_2",this._ship.personTwo.name),n=this.updateTrope(n,"he_or_she_2",this._ship.personTwo.heOrShe),n=this.updateTrope(n,"He_Or_She_2",this._ship.personTwo.heOrShe,!0),n=this.updateTrope(n,"him_or_her_2",this._ship.personTwo.himOrHer),n=this.updateTrope(n,"his_or_her_2",this._ship.personTwo.hisOrHer)}},{key:"updateTrope",value:function(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new RegExp(n,"g"),i=r?Utils.capitalize(t):t;return e.replace(a,i)}},{key:"getBaseTrope",value:function(){return e.TROPES[this._type][this.id]}}]),e}();Trope.MAIN="MAIN",Trope.SECONDARY="SECONDARY",Trope.TROPES=TROPES;var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),Idea=function(){function e(n,t,r){_classCallCheck(this,e),n&&(self.isBlank=!1,this.ship=n,this.mainTrope=new Trope(Trope.MAIN,n,t),this.secondaryTrope=new Trope(Trope.SECONDARY,n,r))}return _createClass(e,null,[{key:"blank",value:function(){var n=new e;return n.isBlank=!0,n.ship={},n.mainTrope={text:"Choose a ship,"},n.secondaryTrope={text:"hit the button, and get inspired!"},n}}]),e}(),_slicedToArray=function(){function e(e,n){var t=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(t.push(o.value),!n||t.length!==n);r=!0);}catch(e){a=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw i}}return t}return function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),URL="https://sirnotappearinginthisfic.github.io/ficgenerator/",PermaLink=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"fromUrl",value:function(){var e=location.search;return this.parseQuery(e)}},{key:"toLink",value:function(e,n){var t=(e.id,e.personOne.id),r=e.personTwo.id,a=n.mainTrope.id,i=n.secondaryTrope.id;return URL+"?idea=s"+e.id+"p"+t+"p"+r+"m"+a+"s"+i}},{key:"parseQuery",value:function(e){var n=this.matchIds(e);if(n){var t=_slicedToArray(n,5),r=t[0],a=t[1],i=t[2],o=t[3],s=t[4],h=new Ship(r,a,i);return{ship:h,idea:new Idea(h,o,s)}}}},{key:"matchIds",value:function(e){var n=e.match(/\?idea=s(\d+)p(\d+)p(\d+)m(\d+)s(\d+)$/);if(n)return n.slice(1).map(function(e){return parseInt(e)})}}]),e}(),_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),FicGenerator=function(){function e(n){_classCallCheck(this,e),this.$shipSelector=n("#ship-selector"),this.$goButton=n("#go"),this.$mainTrope=n("#main-trope"),this.$secondaryTrope=n("#secondary-trope"),this.$link=n("#link"),this.$linkContainer=n("#link-container"),this.ship=void 0,this.idea=void 0,this.setupShips(),this.firstIdea(),this.$goButton.click(this.onGo.bind(this))}return _createClass(e,[{key:"setupShips",value:function(){var e=this;Ship.all.map(this.shipOption).forEach(function(n){return e.$shipSelector.append(n)})}},{key:"onGo",value:function(){this.generateIdea()}},{key:"shipOption",value:function(e,n){return'<option value="'+n+'">'+e.map(function(e){return e.name}).join("/")+"</option>"}},{key:"generateIdea",value:function(){var e=this.$shipSelector.val();e?(this.ship=new Ship(parseInt(e)),this.idea=new Idea(this.ship)):(this.ship=new Ship,this.idea=Idea.blank()),this.renderIdea()}},{key:"renderIdea",value:function(){this.$mainTrope.text(this.idea.mainTrope.text),this.$secondaryTrope.text(this.idea.secondaryTrope.text),this.renderLink()}},{key:"renderLink",value:function(){if(this.idea.isBlank)this.$link.text(),this.$link.attr("href",""),this.$linkContainer.addClass("hidden");else{var e=PermaLink.toLink(this.ship,this.idea);this.$link.text(e),this.$link.attr("href",e),this.$linkContainer.removeClass("hidden")}}},{key:"firstIdea",value:function(){var e=PermaLink.fromUrl();if(e){var n=e.ship,t=e.idea;this.ship=n,this.idea=t,this.chooseShip(n),this.renderIdea(t)}else this.generateIdea()}},{key:"chooseShip",value:function(e){this.$shipSelector.val(e.id)}}]),e}();jQuery(function(e){new FicGenerator(e)});